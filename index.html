<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Japa Counter</title>

  <!-- PWA -->
  <link rel="manifest" href="/japa-counter/manifest.json">
  <meta name="theme-color" content="#000000">

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: "Segoe UI", sans-serif;
      user-select: none;
    }

    body {
      height: 100vh;
      width: 100vw;
      background:
        radial-gradient(
          rgba(0, 0, 0, 0.35),
          rgba(0, 0, 0, 0.85)
        ),
        url("om-background.png") center center / cover no-repeat fixed;
      display: flex;
      justify-content: center;
      align-items: center;
      color: #fff;
      overflow: hidden;
    }

    .container {
      text-align: center;
      padding: 20px;
    }

    .om {
      font-size: 140px;
      font-weight: 600;
      line-height: 1;
      animation: breathe 6s ease-in-out infinite;
      text-shadow:
        0 0 25px rgba(255, 200, 100, 0.6),
        0 0 60px rgba(255, 180, 80, 0.4);
    }

    @keyframes breathe {
      0%   { transform: scale(1); opacity: 0.9; }
      50%  { transform: scale(1.08); opacity: 1; }
      100% { transform: scale(1); opacity: 0.9; }
    }

    .count {
      margin-top: 24px;
      font-size: 42px;
      font-weight: 500;
      opacity: 0.95;
    }

    .info {
      margin-top: 10px;
      font-size: 14px;
      opacity: 0.75;
      letter-spacing: 0.5px;
    }

    .hint {
      position: absolute;
      bottom: 20px;
      width: 100%;
      text-align: center;
      font-size: 13px;
      opacity: 0.6;
    }
  </style>
</head>

<body onclick="increment()">

  <div class="container">
    <div class="om">‡•ê</div>

    <div class="count" id="count">0</div>

    <div class="info">
      Mala <span id="mala">0</span> ‚Ä¢
      Beads <span id="beads">0</span>/108 ‚Ä¢
      üî• <span id="streak">0</span> days
    </div>
  </div>

  <div class="hint">Tap anywhere to continue japa</div>

  <script>
    let count = Number(localStorage.getItem("count")) || 0;
    let mala = Math.floor(count / 108);
    let beads = count % 108;

    const today = new Date().toDateString();
    const lastDate = localStorage.getItem("lastDate");
    let streak = Number(localStorage.getItem("streak")) || 0;

    if (lastDate !== today) {
      const yesterday = new Date(Date.now() - 86400000).toDateString();
      streak = lastDate === yesterday ? streak + 1 : 1;
      localStorage.setItem("lastDate", today);
      localStorage.setItem("streak", streak);
    }

    function updateUI() {
      document.getElementById("count").innerText = count;
      document.getElementById("mala").innerText = mala;
      document.getElementById("beads").innerText = beads;
      document.getElementById("streak").innerText = streak;
      localStorage.setItem("count", count);
    }

    function increment() {
      count++;
      mala = Math.floor(count / 108);
      beads = count % 108;
      updateUI();
    }

    updateUI();
  </script>

  <!-- Service Worker -->
  <script>
    if ("serviceWorker" in navigator) {
      window.addEventListener("load", () => {
        navigator.serviceWorker.register("/japa-counter/service-worker.js");
      });
    }
  </script>

</body>
</html>
